GET snaps/_search
{

  "sort": [
    {
      "lpr.keyword": {
        "order": "asc"
      }
    },
    {
      "dateTime": {
        "order": "asc"
      }
    }
  ],
  "query": {
    "bool": {
      "must": {
        "term": {
          "direction": "in"
        }
      },
      "filter": [
        {
          "terms": {
            "cameraId": [
              12,
              99010,
              99011,
              99012,
              99020,
              99021,
              99022,
              99030
            ]
          }
        },
        {
          "range": {
            "dateTime": {
              "gte": "2018-09-24",
              "lt": "2018-09-25"
            }
          }
        }
      ]
    }
  },
  "aggs": {
    "lprs": {
      "terms": {
        "field": "lpr.keyword"
      },
      "aggs": {
        "times": {
          "date_histogram": {
            "field": "dateTime",
            "interval": "1s",
            "min_doc_count": 1
          },
          "aggs": {
            "cameras": {
              "terms": {
                "field": "cameraId"
              }
            }
          }
        }
      }
    }
  }
}
